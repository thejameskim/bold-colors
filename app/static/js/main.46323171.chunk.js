(this["webpackJsonpcore-app"]=this["webpackJsonpcore-app"]||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){e.exports=n(30)},,,,,,function(e,t,n){},function(e,t,n){},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var i,a=n(0),r=n.n(a),c=n(12),o=n.n(c),l=n(2),s=n(3),h=n.n(s),u=n(7),d=(n(19),n(8)),v=n(6),g=function(){function e(){Object(d.a)(this,e)}return Object(v.a)(e,null,[{key:"getPixelRGBTouch",value:function(e,t,n){var i=t.getBoundingClientRect(),a=n.changedTouches[0].clientX-i.left,r=n.changedTouches[0].clientY-i.top,c=e.getImageData(a,r,1,1).data;return{r:c[0],g:c[1],b:c[2]}}},{key:"getPixelRGBMouse",value:function(e,t,n){var i=t.getBoundingClientRect(),a=n.clientX-i.left,r=n.clientY-i.top,c=e.getImageData(a,r,1,1).data;return{r:c[0],g:c[1],b:c[2]}}},{key:"RGBtoHSV",value:function(e){var t=e.r,n=e.g,i=e.b,a={h:0,s:0,v:0},r=Math.min(t,n,i),c=Math.max(t,n,i);a.v=c;var o=c-r;return 0===c?(a.s=0,a.h=-1,a):(a.s=o/c*255,a.h=t===c?(n-i)/o:n===c?2+(i-t)/o:4+(t-n)/o,a.h*=60,a.h<0&&(a.h+=360),a.h/=2,a)}},{key:"GetHsvFormatted",value:function(e,t,n){return[e.h+=t,e.s+=t,e.v+=t,n]}},{key:"contrastImage",value:function(e,t){for(var n=e.data,i=128*(1-(t/100+1)),a=0;a<n.length;a+=4)for(var r=a;r<a+3;r++)n[r]=n[r]*t+i;return n}}]),e}(),m=function(e){var t=e.cvHelper,n=e.hideWelcome,i=e.hideWelcomeFunc,c=Object(a.useRef)(null),o=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e;if(c){var a=c.current,r=o.current;if(!a||!r)return;var l=a.getContext("2d"),s=r.getContext("2d");if(!l||!s)return;t.setCanvasElCurrent(a,r),a.addEventListener("mousedown",(function(e){n||i(!0);var a=g.getPixelRGBMouse(l,r,e),c=g.RGBtoHSV(a);t.setHSVSelectColor(c)})),a.addEventListener("touchend",(function(e){n||i(!0);var a=g.getPixelRGBTouch(l,r,e),c=g.RGBtoHSV(a);t.setHSVSelectColor(c)})),e=setInterval(Object(u.a)(h.a.mark((function e(){var n,i,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.getLatestVideoFrame(),l.drawImage(n,0,0,window.innerWidth,.9*window.innerHeight),i=l.getImageData(0,0,window.innerWidth,.9*window.innerHeight),c=new ImageData(new Uint8ClampedArray(i.data),i.width,i.height),g.contrastImage(c,2.5),s.putImageData(c,0,0),o=s.getImageData(0,0,window.innerWidth,.9*window.innerHeight),l.putImageData(o,0,0),t.draw(l,a,s,r,o);case 9:case"end":return e.stop()}}),e)}))),.017)}return function(){clearInterval(e)}}),[c,t]),Object(a.useEffect)((function(){window.addEventListener("resize",(function(){c&&c.current&&(c.current.width=window.innerWidth,c.current.height=.9*window.innerHeight),t.setSourceAndDestination(.9*window.innerHeight,window.innerWidth)}))}),[c,t]),r.a.createElement("div",{className:"graphics-core"},r.a.createElement("canvas",{height:.9*window.innerHeight,width:window.innerWidth,ref:c}),r.a.createElement("canvas",{style:{margin:0,padding:0},hidden:!0,height:.9*window.innerHeight,width:window.innerWidth,ref:o}))};!function(e){e.CIRCLE="Circle",e.RECTANGLE="Rectangle",e.NONE="None"}(i||(i={}));var w={RED:"#FF0000"},f=(n(20),[i.CIRCLE,i.RECTANGLE,i.NONE]),p=0,E=0,C=function(e){var t=e.cvHelper,n=e.hide,i=e.setHide,c=Object(a.useState)(0),o=Object(l.a)(c,2),s=o[0],h=o[1],u=Object(a.useState)(0),d=Object(l.a)(u,2),v=d[0],g=d[1],m=Object.keys(w).map((function(e){return e}));return r.a.createElement("div",{className:"settings-pane "+n},r.a.createElement("h1",null,"Settings"),r.a.createElement("div",{id:"shapes-pane"},r.a.createElement("h2",null,"Shape"),r.a.createElement("select",{value:f[s],onChange:function(e){var n=f[e.target.selectedIndex];t.setShape(n),h(e.target.selectedIndex)}},f.map((function(e){return r.a.createElement("option",{key:e},e)})))),r.a.createElement("div",{id:"colors-pane"},r.a.createElement("h2",null,"Color"),r.a.createElement("select",{value:m[v].toLowerCase(),onChange:function(e){var n=w[m[e.target.selectedIndex]];t.setHighlightColor(n),g(e.target.selectedIndex)}},m.map((function(e){return r.a.createElement("option",{key:e},e.toLowerCase())})))),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){i(!0),E=s,p=v}},"Save"),r.a.createElement("button",{onClick:function(){var e=f[E],n=w[m[p]];t.setShape(e),t.setHighlightColor(n),g(p),h(E),i(!0)}},"Cancel")))},S={video:{facingMode:"environment",width:{exact:1280},height:{exact:720}}},H=function(e){var t=Object(a.useState)(void 0),n=Object(l.a)(t,2),i=n[0],r=n[1];return Object(a.useEffect)((function(){if(i)return function(){i.getTracks().forEach((function(e){e.stop()}))};!function(e,t){b.apply(this,arguments)}(e,r)}),[i,e]),i};function b(){return(b=Object(u.a)(h.a.mark((function e(t,n){var i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia(t);case 3:i=e.sent,n(i),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(null);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.cv;Object(d.a)(this,e),this.cv=t,this.videoEl=void 0,this.height=void 0,this.width=void 0,this.cvVideoCapture=void 0,this.cvSource=void 0,this.cvDestination=void 0,this.cvHSV=void 0,this.cvHSVSelectColor=void 0,this.highlightColor=w.RED,this.shape=i.CIRCLE,this.canvasElCurrent=void 0,this.canvasEl2Current=void 0}return Object(v.a)(e,null,[{key:"newOpenCVHelper",value:function(){return new e}}]),Object(v.a)(e,[{key:"setVideoEl",value:function(e,t,n){if(this.videoEl=e,e.current)try{this.videoEl.current&&(this.cvVideoCapture=new this.cv.VideoCapture(this.videoEl.current)),this.setHeightAndWidth(t,n),this.cv.Mat&&this.setSourceAndDestination(t,n)}catch(i){console.log("ERR: ",i)}}},{key:"setSourceAndDestination",value:function(e,t){this.setHeightAndWidth(e,t),this.cvSource=new this.cv.Mat(e,t,this.cv.CV_8UC4),this.cvDestination=new this.cv.Mat(e,t,this.cv.CV_8UC1),this.cvHSV=new this.cv.Mat}},{key:"getHighlightColor",value:function(){return this.highlightColor}},{key:"setHighlightColor",value:function(e){this.highlightColor=e}},{key:"getShape",value:function(){return this.shape}},{key:"setShape",value:function(e){this.shape=e}},{key:"setHSVSelectColor",value:function(e){this.cvHSVSelectColor=e}},{key:"setCanvasElCurrent",value:function(e,t){this.canvasElCurrent||(this.canvasElCurrent=e),this.canvasEl2Current||(this.canvasEl2Current=t)}},{key:"getLatestVideoFrame",value:function(){if(!this.videoEl||!this.videoEl.current)throw new Error("Video is not provided");return this.videoEl.current}},{key:"getFrameAsImage",value:function(){var e,t=null===(e=this.canvasElCurrent)||void 0===e?void 0:e.toDataURL("image/png"),n=document.createElement("a");n.download="ScreenCapture".concat((new Date).toISOString(),".png"),n.href=t,n.click()}},{key:"draw",value:function(e,t,n,a,r){if(this.cv.Mat&&this.cv.MatVector&&this.cvVideoCapture&&this.cvDestination&&this.cvHSVSelectColor&&this.cvHSV&&this.cvSource&&this.height&&this.width){var c=this.cv.matFromImageData(r),o=g.GetHsvFormatted(this.cvHSVSelectColor,-30,0),l=g.GetHsvFormatted(this.cvHSVSelectColor,30,255);this.cv.cvtColor(c,this.cvHSV,this.cv.COLOR_RGB2HSV);var s=new this.cv.Mat(this.cvHSV.rows,this.cvHSV.cols,this.cvHSV.type(),o),h=new this.cv.Mat(this.cvHSV.rows,this.cvHSV.cols,this.cvHSV.type(),l);this.cv.inRange(this.cvHSV,s,h,this.cvHSV);var u=new this.cv.MatVector,d=new this.cv.Mat;this.cv.findContours(this.cvHSV,u,d,this.cv.RETR_LIST,this.cv.CHAIN_APPROX_SIMPLE);var v=this.groupContoursAsRectangles(u);switch(this.shape){case i.RECTANGLE:this.drawRect(v,e);break;case i.CIRCLE:this.drawCircle(v,e)}c.delete(),this.cvHSV.delete(),this.cvHSV=new this.cv.Mat,s.delete(),h.delete(),u.delete(),d.delete(),v.delete()}}},{key:"setHeightAndWidth",value:function(e,t){this.height=e,this.width=t}},{key:"groupContoursAsRectangles",value:function(e){for(var t=new this.cv.RectVector,n=new this.cv.IntVector,i=0;i<e.size();i++){var a=e.get(i),r=this.cv.boundingRect(a);t.push_back(r),t.push_back(r)}return this.cv.groupRectangles(t,n,1,2),n.delete(),t}},{key:"drawRect",value:function(e,t){for(var n=0;n<e.size();n++){var i=e.get(n);i.width>5&&i.height>5&&(t.beginPath(),t.lineWidth=5,t.strokeStyle=this.highlightColor,t.rect(i.x,i.y,i.width,i.height),t.stroke())}}},{key:"drawCircle",value:function(e,t){for(var n=0;n<e.size();n++){var i=e.get(n),a=Math.max(i.width,i.height)/2,r=i.x+i.width/2,c=i.y+i.height/2;i.width>5&&i.height>5&&(t.beginPath(),t.lineWidth=5,t.strokeStyle=this.highlightColor,t.ellipse(r,c,a,a,0,0,360),t.stroke())}}}]),e}(),y=n(4),V=n(5),O=(n(26),function(e){var t=e.cvHelper,n=e.height,i=e.setHideSetting,a=e.setHideHelp;return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{style:{height:n}},r.a.createElement("button",{onClick:a},r.a.createElement(y.a,{icon:V.c,color:"white"})),r.a.createElement("button",{onClick:function(){t.getFrameAsImage()}},r.a.createElement(y.a,{icon:V.a})),r.a.createElement("button",{onClick:i},r.a.createElement(y.a,{icon:V.b}))))}),R=(n(27),function(e){var t=e.hide;return r.a.createElement("div",{id:"welcome-pu",className:t?"hidden":""},r.a.createElement("h1",null,r.a.createElement("span",null,"Welcome to"),r.a.createElement("br",null),"Bold Colors"),r.a.createElement("p",null,"Start by tapping an object below."),r.a.createElement("p",null,"v1.0.2"))}),j=(n(28),[{image:"./img/person.png",desc:"Point application to climbing way"},{image:"./img/fingers.png",desc:"Tap on the location you'd like to route"},{image:"./img/brain.png",desc:"Memorize and/or photograph the route"}]),I=function(e){var t=e.hide,n=e.hideFunc,i=e.windowWidth,a=e.windowHeight,c=j.map((function(e,t){return r.a.createElement(x,{key:t,stepData:e})})),o={left:i/20+"px",top:a/15+"px"};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:o,className:"helpPane "+(t?"hidden":"")},r.a.createElement("button",{onClick:function(){n(!0)}},r.a.createElement(y.a,{icon:V.d})),r.a.createElement("h1",null,r.a.createElement("span",null,"How to use"),r.a.createElement("br",null),"Bold Colors"),r.a.createElement("ol",null,c)),r.a.createElement("div",{className:"popup-bg "+(t?"hidden":"")},"\xa0"))},x=function(e){var t=e.stepData,n="url('"+t.image+"')";return r.a.createElement("li",null,t.desc,r.a.createElement("div",{className:"instruct-img",style:{backgroundImage:n}}," "))},W=(n(29),k.newOpenCVHelper());var D=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(!0),o=Object(l.a)(c,2),s=o[0],h=o[1],u=Object(a.useState)(!0),d=Object(l.a)(u,2),v=d[0],g=d[1],w=Object(a.useState)(window.innerHeight),f=Object(l.a)(w,2),p=f[0],E=f[1],b=Object(a.useState)(window.innerWidth),k=Object(l.a)(b,2),y=k[0],V=k[1],j=Object(a.useRef)(null),x=H(S);return Object(a.useEffect)((function(){window.addEventListener("resize",(function(){E(window.innerHeight),V(window.innerWidth)}))})),j&&W.setVideoEl(j,.9*p,y),x&&j.current&&!j.current.srcObject&&(j.current.srcObject=x),r.a.createElement("div",{className:"main-app"},r.a.createElement(I,{hide:v,hideFunc:g,windowWidth:y,windowHeight:p}),r.a.createElement(R,{hide:n}),r.a.createElement(m,{cvHelper:W,hideWelcome:n,hideWelcomeFunc:i}),r.a.createElement(C,{cvHelper:W,hide:s?"hidden":"",setHide:h}),r.a.createElement("div",null,r.a.createElement("video",{autoPlay:!0,playsInline:!0,muted:!0,hidden:!0,onCanPlay:function(){return function(e){var t;null===(t=e.current)||void 0===t||t.play()}(j)},height:.9*p,width:y,ref:j,id:"video-el"})),r.a.createElement(O,{cvHelper:W,height:.08*p,setHideSetting:function(){h(!s)},setHideHelp:function(){g(!v)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[13,1,2]]]);
//# sourceMappingURL=main.46323171.chunk.js.map